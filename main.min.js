function Task(){this.title="empty",this.done=Observable(!1),this._id=Math.floor(999999*Math.random()+1)}function addTask(a){_task=new Task,_task.title=textInput.value,tasks.insert({title:_task.title,done:_task.done.value,_id:_task._id}),tasks.save(function(a){a||(result.add(_task),textInput.value="",valueChanged(),isResultEmpty())})}function setToDone(a){tasks.update({_id:a.data._id},{$overwrite:{done:!a.data.done.value}}),tasks.save(function(b){b||(a.data.done.value=!a.data.done.value)})}function remove(a){tasks.remove({_id:{$eq:a.data._id}}),tasks.save(function(b){b||(result.remove(a.data),isResultEmpty())})}function valueChanged(){textInput.value.length>=1?textInputNotEmpty.value=!0:textInputNotEmpty.value=!1}function isResultEmpty(){null!=result.value?noTasks.value=!1:noTasks.value=!0}function initDB(){tasks.load(function(a,b,c){if(!a){var d=tasks.find();d.forEach(function(a){var b=new Task;b.title=a.title,b.done.value=a.done,b._id=a._id,result.add(b)}),isResultEmpty()}})}var Observable=require("FuseJS/Observable"),fdb=new ForerunnerDB,db=fdb.db("todolist"),tasks=db.collection("tasks"),result=Observable(),textInput=Observable(""),textInputNotEmpty=Observable(!1),noTasks=Observable(!0);initDB(),module.exports={addTask:addTask,result:result,textInput:textInput,remove:remove,setToDone:setToDone,textInputNotEmpty:textInputNotEmpty,valueChanged:valueChanged,noTasks:noTasks};